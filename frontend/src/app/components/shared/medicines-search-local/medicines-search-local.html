<section class="search-container" aria-labelledby="search-title">
  <!-- Header -->
  <header class="header">
    <h1 id="search-title">Búsqueda Local de Medicamentos</h1>
    <p class="subtitle">Filtrado en tiempo real con debounce (sin llamadas API)</p>
  </header>

  <!-- Barra de búsqueda -->
  <div class="search-bar">
    <div class="search-input-wrapper">
      <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" aria-hidden="true">
        <circle cx="11" cy="11" r="8"/>
        <path d="m21 21-4.35-4.35"/>
      </svg>
      
      <input 
        type="search" 
        [formControl]="searchControl" 
        placeholder="Buscar por nombre, dosis o descripción..."
        class="search-input"
        autocomplete="off"
        aria-label="Buscar medicamentos"
        aria-describedby="search-info">
      
      @if (searchControl.value) {
        <button 
          (click)="clearSearch()" 
          class="clear-button"
          type="button"
          aria-label="Limpiar búsqueda">
          <span aria-hidden="true">✕</span>
        </button>
      }
    </div>

    <!-- Info técnica -->
    <div class="search-info" id="search-info">
      <span class="info-badge">
        <strong>Debounce:</strong> 300ms
      </span>
      <span class="info-badge">
        <strong>Tipo:</strong> Filtrado local (en memoria)
      </span>
      <span class="info-badge">
        <strong>Campos:</strong> Nombre, dosis, descripción
      </span>
    </div>
  </div>

  <!-- Resultados -->
  <section class="results-section" aria-labelledby="results-title">
    <h2 id="results-title" class="visually-hidden">Resultados de búsqueda</h2>
    @if (filteredMedicines$ | async; as medicines) {
      <!-- Info de resultados -->
      <div class="results-header">
        @if (searchControl.value) {
          <p class="results-count" role="status">
            Encontrados <strong>{{ medicines.length }}</strong> medicamento(s)
          </p>
        } @else {
          <p class="results-count" role="status">
            Mostrando <strong>{{ medicines.length }}</strong> medicamento(s)
          </p>
        }
      </div>

      <!-- Lista de medicamentos -->
      @if (medicines.length > 0) {
        <ul class="medicines-list" role="list">
          @for (medicine of medicines; track medicine.id) {
            <li class="medicine-item" role="listitem">
              <article class="medicine-info">
                <h3 class="medicine-name">{{ medicine.name }}</h3>
                @if (medicine.dosage) {
                  <p class="medicine-dosage">{{ medicine.dosage }}</p>
                }
                @if (medicine.description) {
                  <p class="medicine-description">{{ medicine.description }}</p>
                }
              </article>
            </li>
          }
        </ul>
      } @else {
        <div class="no-results" role="status" aria-live="polite">
          <p>No se encontraron medicamentos que coincidan con "{{ searchControl.value }}"</p>
        </div>
      }
    }
  </section>
</section>
