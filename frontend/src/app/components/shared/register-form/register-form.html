<form class="register-form" [formGroup]="registerForm" (ngSubmit)="onSubmit()" autocomplete="off">
	<app-loading-spinner [isVisible]="isLoading" message="Validando credenciales..." [fullScreen]="true"></app-loading-spinner>

	<fieldset class="register-form__fieldset">
		
		<div class="register-form__field-group">
			<label for="username" class="register-form__label">Introduce el nombre de usuario:</label>
			<app-data-input
				id="username"
				formControlName="username"
				placeholder="Usuario123"
				icon="/Icono Usuario.svg"
				type="text"
				aria-describedby="username-error username-loading"
			></app-data-input>
			<div id="username-loading" *ngIf="registerForm.get('username')?.pending" class="loading" role="status">Comprobando disponibilidad...</div>
			<div id="username-error" class="form-error" *ngIf="registerForm.get('username')?.touched && registerForm.get('username')?.invalid" role="alert">{{ getErrorMessage('username') }}</div>
		</div>

		<div class="register-form__field-group">
			<label for="password" class="register-form__label">Introduce la contraseña:</label>
			<app-data-input
				id="password"
				formControlName="password"
				placeholder="Contraseña"
				icon="/Icono contraseña.svg"
				type="password"
				aria-describedby="password-error"
			></app-data-input>
			<div id="password-error" class="form-error" *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid" role="alert">
				<ul>
					<li *ngIf="registerForm.get('password')?.errors?.['noUppercase']">Debe contener al menos una letra mayúscula</li>
					<li *ngIf="registerForm.get('password')?.errors?.['noLowercase']">Debe contener al menos una letra minúscula</li>
					<li *ngIf="registerForm.get('password')?.errors?.['noNumber']">Debe contener al menos un número</li>
					<li *ngIf="registerForm.get('password')?.errors?.['noSpecial']">Debe contener al menos un carácter especial</li>
					<li *ngIf="registerForm.get('password')?.errors?.['minLength']">Debe tener al menos {{ registerForm.get('password')?.errors?.['minLength'].requiredLength }} caracteres</li>
				</ul>
			</div>
		</div>

		<div class="register-form__field-group">
			<label for="email" class="register-form__label">Introduce el email:</label>
			<app-data-input
				id="email"
				formControlName="email"
				placeholder="correo@ejemplo.com"
				icon="/Icono de email.svg"
				type="email"
				aria-describedby="email-error email-loading"
			></app-data-input>
			<div id="email-loading" *ngIf="registerForm.get('email')?.pending" class="loading" role="status">Verificando...</div>
			<div id="email-error" class="form-error" *ngIf="registerForm.get('email')?.touched && registerForm.get('email')?.invalid" role="alert">{{ getErrorMessage('email') }}</div>
		</div>

		<app-button
			variant="primary"
			[width]="'100%'"
			[padding]="'12px 24px'"
			[fontSize]="'1.25rem'"
			type="submit"
			[disabled]="registerForm.invalid || registerForm.pending || isLoading"
		>
			{{ registerForm.pending || isLoading ? 'Validando...' : 'Crear Cuenta' }}
		</app-button>

		<section class="register-form__login-section">
			<h2 class="register-form__login-heading">¿Ya tienes cuenta?</h2>
			<a routerLink="/iniciar-sesion" class="register-form__login-link">
				<app-button
					variant="primary"
					[width]="'100%'"
					[padding]="'12px 24px'"
					[fontSize]="'1.25rem'"
				>
					Iniciar Sesion
				</app-button>
			</a>
		</section>
	</fieldset>
</form>
