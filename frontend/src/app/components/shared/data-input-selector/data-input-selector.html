<div class="selector-container">
  <button
    class="selector-button"
    [class.open]="isOpen"
    [class.selected]="selectedOption !== null"
    [class.disabled]="disabled"
    (click)="toggleDropdown()"
    [disabled]="disabled"
    type="button"
    [attr.aria-haspopup]="'listbox'"
    [attr.aria-expanded]="isOpen"
  >
    <span class="selector-text">{{ getDisplayText() }}</span>
    
    <svg 
      class="selector-arrow"
      [class.rotated]="isOpen"
      width="20" 
      height="20" 
      viewBox="0 0 20 20" 
      fill="none"
      aria-hidden="true">
      <path d="M5 7.5L10 12.5L15 7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <div class="options-container" *ngIf="isOpen" (click)="$event.stopPropagation()" role="listbox">
    <div class="options-list" [class.color-mode]="type === 'color'">
      <div 
        *ngFor="let option of options; trackBy: trackById"
        class="option-item"
        [class.color-option]="type === 'color'"
        [class.selected]="selectedOption?.id === option.id"
        (click)="selectOption(option)"
        role="option"
        [attr.aria-selected]="selectedOption?.id === option.id">
        
        <ng-container [ngSwitch]="type">
          <!-- Modo texto -->
          <span *ngSwitchCase="'text'" class="option-text">
            {{ option.label }}
          </span>

          <!-- Modo color -->
          <ng-container *ngSwitchCase="'color'">
            <div class="color-wrapper">
              <div 
                class="color-box" 
                [style.backgroundColor]="option.color"
                [attr.aria-label]="option.label"
              >
              </div>
              <span class="color-label">{{ option.label }}</span>
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>
  </div>
</div>
