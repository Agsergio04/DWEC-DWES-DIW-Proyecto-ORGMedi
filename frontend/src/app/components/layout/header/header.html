<header class="app-header">
  <!-- IZQUIERDA -->
  <div class="app-header__brand">
    <a class="app-header__logo" routerLink="/" aria-label="Inicio - ORGMed">
      <!-- SVG: eclipse11 logo -->
      <svg
        width="44"
        height="44"
        viewBox="0 0 44 44"
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
        focusable="false"
        class="app-header__svg-logo"
      >
        <defs>
          <radialGradient id="eclipse11-grad" cx="30%" cy="30%" r="80%">
            <stop offset="0%" stop-color="#FFD6EC" />
            <stop offset="100%" stop-color="#E177B5" />
          </radialGradient>
        </defs>
        <rect width="44" height="44" rx="10" fill="url(#eclipse11-grad)" />
        <!-- crescent to simulate eclipse -->
        <path
          d="M30 6 C24 6 20 10 20 16 C20 22 26 28 30 28 C34 28 38 24 38 18 C38 12 36 6 30 6 Z"
          fill="rgba(0,0,0,0.08)"
        />
        <g transform="translate(6,6)">
          <circle cx="6" cy="6" r="6" fill="#fff" opacity="0.9" />
          <rect
            x="14"
            y="2"
            width="14"
            height="8"
            rx="4"
            fill="#fff"
            opacity="0.9"
          />
        </g>
      </svg>
      <span class="app-header__title">ORGMedi</span>
    </a>
  </div>

  <!-- Botón hamburguesa (visible en pantallas pequeñas) -->
  <button
    #menuButton
    class="app-header__hamburger"
    (click)="toggleMenu()"
    aria-label="Menú principal"
    [attr.aria-expanded]="isOpen"
    aria-controls="main-nav-menu"
    [attr.aria-pressed]="isOpen"
  >
    <span class="app-header__hamburger-line"></span>
    <span class="app-header__hamburger-line"></span>
    <span class="app-header__hamburger-line"></span>
    <span class="sr-only">desliza ↓ </span>
  </button>

  <!-- Overlay para cerrar el menú al hacer clic fuera -->
  <div
    class="app-header__overlay"
    (click)="closeMenu()"
    [class.is-visible]="isOpen"
    aria-hidden="true"
  ></div>

  <!-- DERECHA: navegación principal -->
  <nav
    #navMenu
    id="main-nav-menu"
    class="app-header__nav"
    [class.is-open]="isOpen"
    [attr.aria-hidden]="!isOpen"
    role="navigation"
    aria-label="Navegación principal"
  >
    <ng-container *ngIf="!isAuthRoute">
      <a
        class="app-header__nav-item app-header__pill"
        routerLink="/pastillas"
        routerLinkActive="is-active"
        [attr.aria-current]="router.isActive('pastillas', true) ? 'page' : null"
        aria-label="Ver pastillas"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Pastillas (pill) -->
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="app-header__icon-svg"
            focusable="false"
          >
            <rect
              x="2"
              y="8"
              width="20"
              height="8"
              rx="4"
              fill="currentColor"
            />
            <rect
              x="2"
              y="8"
              width="10"
              height="8"
              rx="4"
              fill="currentColor"
              opacity="0.18"
            />
            <line
              x1="7"
              y1="8"
              x2="7"
              y2="16"
              stroke="currentColor"
              stroke-width="1"
              opacity="0.18"
            />
          </svg>
        </span>
        <span class="app-header__label">Pastillas</span>
      </a>

      <a
        class="app-header__nav-item app-header__pill"
        routerLink="/perfil"
        routerLinkActive="is-active"
        [attr.aria-current]="router.isActive('perfil', true) ? 'page' : null"
        aria-label="Ir al perfil"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Usuario -->
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="app-header__icon-svg"
            focusable="false"
          >
            <circle cx="12" cy="8" r="4" fill="currentColor" />
            <path d="M4 20c0-3.3 4-6 8-6s8 2.7 8 6" fill="currentColor" />
          </svg>
        </span>
        <span class="app-header__label">Perfil</span>
      </a>


      <a
        class="app-header__nav-item app-header__pill app-header__home"
        routerLink="/"
        routerLinkActive="is-active"
        [routerLinkActiveOptions]="{ exact: true }"
        [attr.aria-current]="router.isActive('/', true) ? 'page' : null"
        aria-label="Ir al inicio"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Home: único SVG (casa) que usa currentColor -->
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="app-header__icon-svg"
            focusable="false"
            aria-hidden="true"
          >
            <path
              d="M3 10.5L12 4l9 6.5V20a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V10.5z"
              fill="currentColor"
            />
          </svg>
        </span>
        <span class="app-header__label">Inicio</span>
      </a>
    </ng-container>

    <!-- Botón de tema: siempre visible -->
    <button
      class="app-header__theme-toggle"
      (click)="toggleTheme()"
      aria-label="Cambiar tema"
      [attr.aria-pressed]="isDarkMode"
    >
      <ng-container *ngIf="isDarkMode; else lightIcon">
        <!-- SVG provisto (modo oscuro) -->
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="app-header__icon-svg app-header__theme-icon-svg"
          focusable="false"
          aria-hidden="true"
        >
          <path
            d="M15.222 8.11822H17M16.111 7.22933V9.00711M8.99904 1.00711H9.34841C8.20635 2.06818 7.47226 3.49586 7.27375 5.04197C7.07524 6.58809 7.42485 8.15487 8.26182 9.46998C9.09879 10.7851 10.3702 11.7654 11.855 12.2404C13.3399 12.7155 14.9442 12.6552 16.3893 12.0702C15.8334 13.4075 14.9249 14.5689 13.7607 15.4305C12.5964 16.292 11.2201 16.8214 9.7786 16.9621C8.33706 17.1029 6.88434 16.8497 5.57541 16.2297C4.26648 15.6096 3.15043 14.646 2.34631 13.4414C1.54219 12.2369 1.08017 10.8367 1.00952 9.39019C0.93888 7.9437 1.26226 6.50515 1.94518 5.22801C2.6281 3.95087 3.64493 2.88304 4.88722 2.13843C6.1295 1.39382 7.55064 1.00035 8.99904 1V1.00711ZM13.444 1.896C13.444 2.3675 13.6313 2.81968 13.9648 3.15308C14.2982 3.48648 14.7505 3.67378 15.222 3.67378C14.7505 3.67378 14.2982 3.86108 13.9648 4.19448C13.6313 4.52787 13.444 4.98006 13.444 5.45155C13.444 4.98006 13.2567 4.52787 12.9233 4.19448C12.5898 3.86108 12.1376 3.67378 11.666 3.67378C12.1376 3.67378 12.5898 3.48648 12.9233 3.15308C13.2567 2.81968 13.444 2.3675 13.444 1.896Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </ng-container>
      <ng-template #lightIcon>
        <!-- SVG provisto (modo claro) -->
        <svg
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          class="app-header__icon-svg app-header__theme-icon-svg"
          focusable="false"
          aria-hidden="true"
        >
          <path
            d="M9 1V1.88889M9 16.1111V17M17 9H16.1111M1.88889 9H1M14.6569 14.6569L14.0284 14.0284M3.97156 3.97156L3.34311 3.34311M14.6569 3.34311L14.0284 3.97156M3.97156 14.0284L3.34311 14.6569M12.5556 9C12.5556 9.94299 12.181 10.8474 11.5142 11.5142C10.8474 12.181 9.94299 12.5556 9 12.5556C8.05701 12.5556 7.15264 12.181 6.48584 11.5142C5.81905 10.8474 5.44444 9.94299 5.44444 9C5.44444 8.05701 5.81905 7.15264 6.48584 6.48584C7.15264 5.81905 8.05701 5.44444 9 5.44444C9.94299 5.44444 10.8474 5.81905 11.5142 6.48584C12.181 7.15264 12.5556 8.05701 12.5556 9Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </ng-template>
    </button>
  </nav>
</header>
