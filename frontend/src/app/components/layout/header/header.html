<header class="app-header">
  <!-- IZQUIERDA -->
  <div class="app-header__brand">
    <a class="app-header__logo" routerLink="/" aria-label="Inicio - ORGMed">
      <!-- SVG: eclipse11 logo -->
      <svg
        width="44"
        height="44"
        viewBox="0 0 44 44"
        xmlns="http://www.w3.org/2000/svg"
        aria-hidden="true"
        focusable="false"
        class="app-header__svg-logo"
      >
        <defs>
          <radialGradient id="eclipse11-grad" cx="30%" cy="30%" r="80%">
            <stop offset="0%" stop-color="#FFD6EC" />
            <stop offset="100%" stop-color="#E177B5" />
          </radialGradient>
        </defs>
        <rect width="44" height="44" rx="10" fill="url(#eclipse11-grad)" />
        <!-- crescent to simulate eclipse -->
        <path
          d="M30 6 C24 6 20 10 20 16 C20 22 26 28 30 28 C34 28 38 24 38 18 C38 12 36 6 30 6 Z"
          fill="rgba(0,0,0,0.08)"
        />
        <g transform="translate(6,6)">
          <circle cx="6" cy="6" r="6" fill="#fff" opacity="0.9" />
          <rect
            x="14"
            y="2"
            width="14"
            height="8"
            rx="4"
            fill="#fff"
            opacity="0.9"
          />
        </g>
      </svg>
      <span class="app-header__title">ORGMedi</span>
    </a>
  </div>

  <!-- Botón hamburguesa (visible en pantallas pequeñas) -->
  <div class="app-header__controls">
    <button
      #menuButton
      class="app-header__hamburger"
      (click)="toggleMenu()"
      aria-label="Menú principal"
      [attr.aria-expanded]="isOpen"
      aria-controls="main-nav-menu"
      [attr.aria-pressed]="isOpen"
    >
      <span class="app-header__hamburger-line"></span>
      <span class="app-header__hamburger-line"></span>
      <span class="app-header__hamburger-line"></span>
      <span class="sr-only">desliza ↓ </span>
    </button>

    <!-- Hint visible en móvil: 'desliza' con pequeña flecha -->
    <span class="app-header__hamburger-hint" aria-hidden="true">
      <svg
        class="app-header__hamburger-icon"
        width="14"
        height="14"
        viewBox="0 0 24 24"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        focusable="false"
        aria-hidden="true"
      >
      </svg>
    </span>
  </div>

  <!-- Overlay para cerrar el menú al hacer clic fuera -->
  <div
    class="app-header__overlay"
    (click)="closeMenu()"
    [class.is-visible]="isOpen"
    aria-hidden="true"
  ></div>

  <!-- DERECHA: navegación principal -->
  <nav
    #navMenu
    id="main-nav-menu"
    class="app-header__nav"
    [class.is-open]="isOpen"
    [attr.aria-hidden]="!isOpen"
    role="navigation"
    aria-label="Navegación principal"
  >
    <ng-container *ngIf="!isAuthRoute">
      <a
        class="app-header__nav-item app-header__pill"
        routerLink="/pastillas"
        routerLinkActive="is-active"
        [attr.aria-current]="router.isActive('pastillas', true) ? 'page' : null"
        aria-label="Ver pastillas"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Pastillas (pill) -->
          <svg
            width="36"
            height="36"
            viewBox="0 0 36 36"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M11.1716 11.3726C10.8001 11.8078 10.5055 12.3244 10.3045 12.8929C10.1035 13.4615 10 14.0709 10 14.6863C10 15.3017 10.1035 15.9111 10.3045 16.4797C10.5055 17.0482 10.8001 17.5649 11.1716 18L18 26L24.8284 18C25.5786 17.1212 26 15.9292 26 14.6863C26 13.4434 25.5786 12.2514 24.8284 11.3726C24.0783 10.4937 23.0609 10 22 10C20.9391 10 19.9217 10.4937 19.1716 11.3726L18 12.7452L16.8285 11.3726C16.457 10.9374 16.0161 10.5922 15.5308 10.3567C15.0455 10.1212 14.5253 10 14 10C13.4747 10 12.9546 10.1212 12.4693 10.3567C11.984 10.5922 11.543 10.9374 11.1716 11.3726Z"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <span class="app-header__label">Pastillas</span>
      </a>

      <a
        class="app-header__nav-item app-header__pill"
        routerLink="/perfil"
        routerLinkActive="is-active"
        [attr.aria-current]="router.isActive('perfil', true) ? 'page' : null"
        aria-label="Ir al perfil"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Usuario -->
          <svg
            width="36"
            height="36"
            viewBox="0 0 36 36"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M22.5714 13.5556C22.5714 14.4985 22.0898 15.4029 21.2325 16.0697C20.3752 16.7365 19.2124 17.1111 18 17.1111C16.7876 17.1111 15.6248 16.7365 14.7675 16.0697C13.9102 15.4029 13.4286 14.4985 13.4286 13.5556C13.4286 12.6126 13.9102 11.7082 14.7675 11.0414C15.6248 10.3746 16.7876 10 18 10C19.2124 10 20.3752 10.3746 21.2325 11.0414C22.0898 11.7082 22.5714 12.6126 22.5714 13.5556ZM18 19.7778C15.8783 19.7778 13.8434 20.4333 12.3431 21.6002C10.8429 22.7671 10 24.3498 10 26H26C26 24.3498 25.1571 22.7671 23.6569 21.6002C22.1566 20.4333 20.1217 19.7778 18 19.7778Z"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <span class="app-header__label">Perfil</span>
      </a>

      <a
        class="app-header__nav-item app-header__pill app-header__home"
        routerLink="/"
        routerLinkActive="is-active"
        [routerLinkActiveOptions]="{ exact: true }"
        [attr.aria-current]="router.isActive('/', true) ? 'page' : null"
        aria-label="Ir al inicio"
        (keydown.enter)="closeMenu()"
        (keydown.space)="closeMenu(); $event.preventDefault()"
      >
        <span class="app-header__icon" aria-hidden="true">
          <!-- Icono Home: único SVG (casa) que usa currentColor -->
          <svg
            width="36"
            height="36"
            viewBox="0 0 36 36"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M10 18L11.7778 16.2222M11.7778 16.2222L18 10L24.2222 16.2222M11.7778 16.2222V25.1111C11.7778 25.3469 11.8714 25.573 12.0381 25.7397C12.2048 25.9064 12.4309 26 12.6667 26H15.3333M24.2222 16.2222L26 18M24.2222 16.2222V25.1111C24.2222 25.3469 24.1286 25.573 23.9619 25.7397C23.7952 25.9064 23.5691 26 23.3333 26H20.6667M15.3333 26C15.5691 26 15.7952 25.9064 15.9619 25.7397C16.1286 25.573 16.2222 25.3469 16.2222 25.1111V21.5556C16.2222 21.3198 16.3159 21.0937 16.4826 20.927C16.6493 20.7603 16.8754 20.6667 17.1111 20.6667H18.8889C19.1246 20.6667 19.3507 20.7603 19.5174 20.927C19.6841 21.0937 19.7778 21.3198 19.7778 21.5556V25.1111C19.7778 25.3469 19.8714 25.573 20.0381 25.7397C20.2048 25.9064 20.4309 26 20.6667 26M15.3333 26H20.6667"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
        <span class="app-header__label">Inicio</span>
      </a>
    </ng-container>

    <!-- Botón de tema: siempre visible -->
    <button
      class="app-header__theme-toggle"
      (click)="toggleTheme()"
      aria-label="Cambiar tema"
      [attr.aria-pressed]="isDarkMode"
    >
      <ng-container *ngIf="isDarkMode; else lightIcon">
        <!-- SVG provisto (modo oscuro) -->
        <svg
          class="app-header__icon-svg app-header__theme-icon-svg"
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          focusable="false"
          aria-hidden="true"
        >
          <path
            d="M9 1V1.88889M9 16.1111V17M17 9H16.1111M1.88889 9H1M14.6569 14.6569L14.0284 14.0284M3.97156 3.97156L3.34311 3.34311M14.6569 3.34311L14.0284 3.97156M3.97156 14.0284L3.34311 14.6569M12.5556 9C12.5556 9.94299 12.181 10.8474 11.5142 11.5142C10.8474 12.181 9.94299 12.5556 9 12.5556C8.05701 12.5556 7.15264 12.181 6.48584 11.5142C5.81905 10.8474 5.44444 9.94299 5.44444 9C5.44444 8.05701 5.81905 7.15264 6.48584 6.48584C7.15264 5.81905 8.05701 5.44444 9 5.44444C9.94299 5.44444 10.8474 5.81905 11.5142 6.48584C12.181 7.15264 12.5556 8.05701 12.5556 9Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </ng-container>
      <ng-template #lightIcon>
        <!-- SVG toggle (modo claro) -->
        <svg
          class="app-header__icon-svg app-header__theme-icon-svg"
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          focusable="false"
          aria-hidden="true"
        >
          <path
            d="M9 1V1.88889M9 16.1111V17M17 9H16.1111M1.88889 9H1M14.6569 14.6569L14.0284 14.0284M3.97156 3.97156L3.34311 3.34311M14.6569 3.34311L14.0284 3.97156M3.97156 14.0284L3.34311 14.6569M12.5556 9C12.5556 9.94299 12.181 10.8474 11.5142 11.5142C10.8474 12.181 9.94299 12.5556 9 12.5556C8.05701 12.5556 7.15264 12.181 6.48584 11.5142C5.81905 10.8474 5.44444 9.94299 5.44444 9C5.44444 8.05701 5.81905 7.15264 6.48584 6.48584C7.15264 5.81905 8.05701 5.44444 9 5.44444C9.94299 5.44444 10.8474 5.81905 11.5142 6.48584C12.181 7.15264 12.5556 8.05701 12.5556 9Z"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

      </ng-template>
    </button>
  </nav>

  <!-- Colocar el toast overlay aquí para que esté disponible globalmente y en scope -->
  <app-toast></app-toast>
</header>
